package com.hudson.codes;//å®ç° pow(x, n) ï¼Œå³è®¡ç®— x çš„ n æ¬¡å¹‚å‡½æ•°ã€‚
//
// ç¤ºä¾‹ 1: 
//
// è¾“å…¥: 2.00000, 10
//è¾“å‡º: 1024.00000
// 
//
// ç¤ºä¾‹ 2: 
//
// è¾“å…¥: 2.10000, 3
//è¾“å‡º: 9.26100
// 
//
// ç¤ºä¾‹ 3: 
//
// è¾“å…¥: 2.00000, -2
//è¾“å‡º: 0.25000
//è§£é‡Š: 2-2 = 1/22 = 1/4 = 0.25 
//
// è¯´æ˜: 
//
// 
// -100.0 < x < 100.0 
// n æ˜¯ 32 ä½æœ‰ç¬¦å·æ•´æ•°ï¼Œå…¶æ•°å€¼èŒƒå›´æ˜¯ [âˆ’231, 231 âˆ’ 1] ã€‚ 
// 
// Related Topics æ•°å­¦ äºŒåˆ†æŸ¥æ‰¾ 
// ğŸ‘ 558 ğŸ‘ 0


//leetcode submit region begin(Prohibit modification and deletion)
class Solution50 {

    // æ–¹æ³•1ï¼šæœ€ç›´è§‚çš„æ€è·¯ï¼Œéå†næ¬¡
    // ã€é”™è¯¯1ã€‘æ²¡æœ‰è€ƒè™‘åˆ°næ˜¯è´Ÿæ•°æƒ…å†µ
    // å¯¹nå°äº0çš„æƒ…å†µå–å€’æ•°å³å¯ã€‚ä½†è¦æ³¨æ„æº¢å‡ºé—®é¢˜
    public double myPow(double x, int n) {
        // æˆ‘ä»¬å¯ä»¥å¯¹æƒ³x=1å’Œ-1åšç‰¹æ®Šå¤„ç†ï¼Œå¦‚æœnæ˜¯å¶æ•°ï¼Œé‚£ä¹ˆç»“æœå¿…ç„¶æ˜¯1ï¼Œå¦‚æœnæ˜¯å¥‡æ•°ï¼Œåˆ™åˆ†æƒ…å†µ
        if(x == 1){
            return 1;
        }
        if(x == -1){
            if((n & 1) == 1){
                return -1;
            }
            return 1;
        }
        // å¯¹x=0ç‰¹æ®Šå¤„ç†
        if(x == 0) return 0;
        // å¯¹n=0ç‰¹æ®Šå¤„ç†
        if(n == 0) return 1;
        // é‚£ä¹ˆæˆ‘ä»¬éœ€è¦åˆ†æƒ…å†µåˆ¤æ–­næ˜¯å¦å¤§äº0å’Œæ˜¯å¦å°äº0
        double mul = 1;
        if(n > 0){
            for (int i = 0; i < n; i++) {
                mul *= x;
            }
        }else{
            // å¦‚æœnå°äº0ï¼Œé‚£ä¹ˆæˆ‘ä»¬éœ€è¦å…ˆè½¬ä¸ºæ­£æ•°ï¼Œæœ€åæŠŠç»“æœ 1/mulï¼Œç”±äºè¿™é‡Œè´Ÿæ•°è½¬æ­£æ•°å¯èƒ½æº¢å‡ºï¼Œå› æ­¤éœ€è¦ç‰¹æ®Šå¤„ç†
            if(n == Integer.MIN_VALUE){
                return 0;
            }
            n = -n;
            for (int i = 0; i < n; i++) {
                mul *= x;
            }
            mul = 1 / mul;
        }
        return mul;
    }


    // é€šè¿‡ï¼Œæ—¶é—´ï¼š98.10%ï¼Œç©ºé—´ï¼š67.80%
    // æ€è·¯å¾ˆå¥½ï¼Œä½†å®¹æ˜“å†™é”™ï¼Œç‰¹åˆ«æ˜¯é€’å½’çš„é€»è¾‘ï¼Œä¸»è¦å¯èƒ½æ˜¯æ²¡æœ‰åˆ†æå¥½
    // å®é™…ä¸Šï¼Œä¸ºäº†ä¼˜åŒ–ï¼Œæˆ‘ä»¬å¯ä»¥å°†ä¹˜ä»¥xçš„ç»“æœä½œä¸º
    // æ–°å€¼ï¼Œç”¨å®ƒä¹˜ä»¥è‡ªå·±ï¼Œé‚£ä¹ˆå°±èƒ½å¤Ÿå‡å°‘ä¹‹å‰xä¹˜ä»¥çš„æ¬¡æ•°ï¼Œä¼˜åŒ–äº†ä¸€åŠ
    // è¿™ç§ä¼˜åŒ–æ€è·¯æœ‰ç‚¹ç±»ä¼¼ç¬¬29é¢˜
    public static double myPow2(double x, int n) {
        if(x == 1){
            return 1;
        }
        if(x == -1){
            if((n & 1) == 1){
                return -1;
            }
            return 1;
        }
        // å¯¹x=0ç‰¹æ®Šå¤„ç†
        if(x == 0) return 0;
        // å¯¹n=0ç‰¹æ®Šå¤„ç†
        if(n == 0) return 1;
        // é‚£ä¹ˆæˆ‘ä»¬éœ€è¦åˆ†æƒ…å†µåˆ¤æ–­næ˜¯å¦å¤§äº0å’Œæ˜¯å¦å°äº0
        double mul = 1;
        if(n > 0){
            mul = pow(x, n - 1, 1, x);
        }else{
            // å¦‚æœnå°äº0ï¼Œé‚£ä¹ˆæˆ‘ä»¬éœ€è¦å…ˆè½¬ä¸ºæ­£æ•°ï¼Œæœ€åæŠŠç»“æœ 1/mulï¼Œç”±äºè¿™é‡Œè´Ÿæ•°è½¬æ­£æ•°å¯èƒ½æº¢å‡ºï¼Œå› æ­¤éœ€è¦ç‰¹æ®Šå¤„ç†
            if(n == Integer.MIN_VALUE){
                return 0;
            }
            n = -n;
            mul = pow(x, n - 1, 1, x);
            mul = 1 / mul;
        }
        return mul;
    }

    /**
     *
     * @param mul å½“å‰ä¹˜ç§¯ç»“æœï¼Œå®ƒè¡¨ç¤ºå·²ç»ä½¿ç”¨hasUsedä¸ªtargetä¹˜ç§¯çš„ç»“æœ
     * @param left è¿˜éœ€è¦ä¹˜ä»¥å¤šå°‘ä¸ª
     * @param hasUsed å·²ç»ä½¿ç”¨äº†å¤šå°‘ä¸ª
     * @return
     */
    private static double pow(double mul, int left, int hasUsed, double target){
        if(left <= 0) return mul;
        if(hasUsed <= left){
            // å¦‚æœç»“æœè¿˜å…è®¸ä¹˜ä»¥ä¸€ä¸ªå½“å‰çš„å€¼ï¼Œé‚£ä¹ˆç»§ç»­ä½¿ç”¨ï¼Œå³mulï¼Œç›¸å½“äºhasUsedä¸ªtargetï¼›å‰©ä½™çš„ç»§ç»­æŒ‰ç…§è¿™ç§æ€è·¯èµ°
            mul = mul * mul;
            return pow(mul, left - hasUsed, hasUsed * 2, target);
        }else{
            // å½“å‰çš„å‰©ä½™ä¸å…è®¸ç»§ç»­ä¹˜ä»¥å½“å‰çš„å€¼ï¼Œå› æ­¤ä»ä¸€ä¸ªä¹˜ä»¥å¼€å§‹ï¼Œå³ä½¿ç”¨1ä¸ªtargetï¼Œå¹¶ä¹Ÿæ˜¯ä»¥è®¡ç®—åçš„ç»“æœä½œä¸ºå‚è€ƒå€¼ï¼Œä»¥å‡å°‘è®¡ç®—
            // ä¾‹å¦‚2^7çš„ï¼Œæˆ‘ä»¬å¯ä»¥åˆ’åˆ†ä¸º ï¼ˆ2 * 2 * 2 * 2ï¼‰*ï¼ˆ2 * 2 * 2ï¼‰ï¼Œæ¯ä¸ªæ‹¬å·éƒ½æ˜¯hasUsedä»1å¼€å§‹è®¡ç®—çš„ç»“æœã€å› ä¸ºä»0å¼€å§‹çš„è¯ï¼ŒhasUsed*2æ°¸è¿œæ˜¯0ã€‘
            return mul * pow(target, left - 1, 1, target);
        }
    }
}
//leetcode submit region end(Prohibit modification and deletion)
